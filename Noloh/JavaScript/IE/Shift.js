_N.Catchers=[];function _NShftSta(a){if(_N.ClickOffId){_NClickOffClick()}_N.Shifts=a;_N.Shifts.Ghosts=[];_N.Shifts.ObjsWithStart=[];_N.Shifts.ObjsWithStop=[];_N.Shifts.ActualCount=[];_N.Shifts.HasMoved=false;_N.Shifts.CursorX=window.event.clientX+document.documentElement.scrollLeft+document.body.scrollLeft;_N.Shifts.CursorY=window.event.clientY+document.documentElement.scrollTop+document.body.scrollTop;document.attachEvent("onmousemove",_NShftFirstGo);document.attachEvent("onmouseup",_NShftStp);window.event.cancelBubble=true;window.event.returnValue=false}function _NShftFirstGo(){var e,d,c,b=_N.Shifts.length;if(b>0){c=++_N.HighestZ+b-_N(_N.Shifts[0][0]).style.zIndex}for(var a=0;a<b;++a){d=_N(e=_N.Shifts[a][0]);if(d.ShiftStart&&!_N.Shifts.ObjsWithStart[e]){d.ShiftStart.call(d);_N.Shifts.ObjsWithStart[e]=true}if(d.ShiftStop&&!_N.Shifts.ObjsWithStop[e]){_N.Shifts.ObjsWithStop[e]=d}if(_N.Shifts[a][4]){d=d.cloneNode(true);d.style.position="absolute";d.style.left=_NFindX(e)+"px";d.style.top=_NFindY(e)+"px";d.style.filter="alpha(opacity=50)";_N.Shifts[a][0]=e=d.id=e+"_Ghost";_N("N1").appendChild(d);_N.Shifts.Ghosts.push(a)}_N.Shifts.ActualCount[_N.Shifts[a][7]=_N.Shifts[a][1]+e]=parseInt(_N.Shifts[a][1]==1?d.style.width:_N.Shifts[a][1]==2?d.style.height:_N.Shifts[a][1]==4?d.style.left:d.style.top);_NSetProperty(e,"style.zIndex",parseInt(d.style.zIndex)+c)}delete _N.Shifts.ObjsWithStart;_N.Shifts.HasMoved=true;document.detachEvent("onmousemove",_NShftFirstGo);document.attachEvent("onmousemove",_NShftGo)}function _NShftGo(){var d=window.event.clientX+document.documentElement.scrollLeft+document.body.scrollLeft;var c=window.event.clientY+document.documentElement.scrollTop+document.body.scrollTop;var b=d-_N.Shifts.CursorX;var a=c-_N.Shifts.CursorY;_N.Shifts.CursorX=d;_N.Shifts.CursorY=c;_NShftObjs(_N.Shifts,b,a);window.event.cancelBubble=true;window.event.returnValue=false}function _NShftObjs(f,b,a){var g,d,e=f.length;for(var c=0;c<e;++c){if(g=_N(f[c][0])){if(f[c][1]==1){_NShftProcObj(g,f[c],1,"style.width",1,(d=g.style.width)?d:g.offsetWidth,b,(!f[c][7]||f[c][3])?null:(d=g.style.left)?d:g.offsetLeft)}else{if(f[c][1]==2){_NShftProcObj(g,f[c],2,"style.height",0,(d=g.style.height)?d:g.offsetHeight,a,(!f[c][7]||f[c][3])?null:(d=g.style.top)?d:g.offsetTop)}else{if(f[c][1]==4){_NShftProcObj(g,f[c],4,"style.left",1,(d=g.style.left)?d:g.offsetLeft,b,f[c][3]?null:(d=g.style.width)?d:g.offsetWidth)}else{_NShftProcObj(g,f[c],5,"style.top",0,(d=g.style.top)?d:d.offsetTop,a,f[c][3]?null:(d=g.style.height)?d:g.offsetHeight)}}}}}}function _NShftCalcPrcnt(d,a,e){if(typeof(a)=="string"&&a.charAt(a.length-1)=="%"){var c,b=d.parentNode;if(b){a=parseInt(a)/100;c={"style.width":"offsetWidth","style.left":"offsetWidth","style.height":"offsetHeight","style.top":"offsetHeight"};if(e=c[e]){return a*b[e]}}}return a}function _NShftProcObj(h,c,f,k,d,b,n,j){if(n){b=parseInt(b);var a,e=c[2]==null?(b<0?null:0):(c[2]=="N"?null:_NShftCalcPrcnt(h,c[2],k)),i,g;if(j){var m=h.parentNode;a=(d?(m.id=="N1"?m.Width:(g=m.style.width)?parseInt(g):(m.offsetWidth-(isNaN(g=parseInt(m.style.borderLeftWidth))?0:(2*g)))):(m.id=="N1"?m.Height:(g=m.style.height)?parseInt(g):(m.offsetHeight-(isNaN(g=parseInt(m.style.borderTopWidth))?0:(2*g)))))-parseInt(j);if(b>a){a=null}}else{a=c[3]=="N"?null:_NShftCalcPrcnt(h,c[3],k)}if(c[7]){n=_NShftObj(c[0],k,b,n,e,a,c[5],c[6],_N.Shifts.ActualCount,c[7])}else{if(h._NApparentCount[f]!=b){h._NApparentCount[f]=h._NActualCount[f]=b}n=_NShftObj(c[0],k,b,n,e,a,c[5],c[6],h._NActualCount,f);h._NApparentCount[f]+=n}if(g=_N.ChangeForReflect){var l=parseInt(f==1?h.style.left:h.style.top)+(g=="D"?(-n):g);_NSetProperty(c[0],f==1?"style.left":"style.top",l+"px");delete _N.ChangeForReflect}if(n){if((i=h.ShiftsWith)&&i[f]){_NShftObjs(i[f],n,n)}if(h.ShiftStep){h.ShiftStep.call(h)}}}}function _NShftObj(c,m,d,l,e,b,g,a,f,j){var h=g?(l*g):l;var i=f[j]+=h;i=a?_NRound(i,a,d):Math.round(i);if(e!=null){if(e=="R"){var k=_NRound(f[j]-h,a,d);if(i<0&&k>=0){_N.ChangeForReflect=i}else{if(i>=0&&k<0){_N.ChangeForReflect=d}else{if(i<0){_N.ChangeForReflect="D"}}}i=Math.abs(i)}else{if(i<e){i=e}}}if(b!=null&&i>b){i=b}_NSetProperty(c,m,i+"px");return i-d}function _NShftStp(){var l,h;if((l=_N.Catchers.length)&&_N.Shifts.HasMoved){var b,k,n,d,c,e,a,g,m=[];_N.EventVars.Caught=[];d=window.event.clientX+document.documentElement.scrollLeft+document.body.scrollLeft;c=window.event.clientY+document.documentElement.scrollTop+document.body.scrollTop;for(var f=0;f<l;++f){if(_NAvail(_N.Catchers[f])){b=_N(_N.Catchers[f]);catcherX=_NFindX(_N.Catchers[f]);catcherY=_NFindY(_N.Catchers[f]);if(d>=catcherX&&d<catcherX+((g=b.style.width)==""?((g=b.offsetWidth)?g:80):parseInt(g))&&c>=catcherY&&c<catcherY+((g=b.style.height)==""?((g=b.offsetHeight)?g:20):parseInt(g))){for(e=0;e<_N.Shifts.length;++e){if(4<=_N.Shifts[e][1]&&_N.Shifts[e][1]<=6&&_N.Catchers[f]!=(a=_N.Shifts[e][0].replace("_Ghost",""))&&!m[a]){_N.EventVars.Caught.push(m[a]=a)}}if(_N.EventVars.Caught.length){b.DragCatch.call(b)}}}}}l=_N.Shifts.Ghosts.length;for(f=0;f<l;++f){e=_N.Shifts.Ghosts[f];_N("N1").removeChild(_N(_N.Shifts[e][0]));_N.Shifts[e][0]=_N.Shifts[e][0].replace("_Ghost","")}if(_N.Shifts.HasMoved){for(var a in _N.Shifts.ObjsWithStop){h=_N.Shifts.ObjsWithStop[a];h.ShiftStop.call(h)}document.detachEvent("onmousemove",_NShftGo);window.event.returnValue=false;_N.DisableClicks=true;window.setTimeout(function(){delete _N.DisableClicks},0)}else{l=_N.Shifts.length;for(f=0;f<l;++f){h=_N(_N.Shifts[f][0]);if(h.onclick){h.onclick.call(h)}}document.detachEvent("onmousemove",_NShftFirstGo)}_N.Shifts=null;document.detachEvent("onmouseup",_NShftStp)}function _NShftWth(e){var d=_N(e),a,c=arguments.length,b=0;if(d.ShiftsWith==null){d.ShiftsWith=[]}while(++b<c){if(d.ShiftsWith[arguments[b]]==null){d.ShiftsWith[arguments[b]]=[arguments[++b]]}else{d.ShiftsWith[arguments[b]].push(arguments[++b])}if((a=_N(arguments[b][0]))&&!a._NActualCount){a._NActualCount=[];a._NApparentCount=[]}}}function _NShftGC(){for(var c=0,e=arguments.length;c<e;++c){var f=_N(arguments[c]).ShiftsWith,d;for(d in f){for(var b=0,a=f[d].length;b<a;++b){if(!_N(f[d][b][0])){f[d].splice(b--,1);--a}}}}}function _NRound(c,d,a){var b=(a?(c-a):c)%d;if(b<0){b+=d}return(b>=d/2)?(c+d-b):(c-b)};