function _NListener(c,f,e,b){this.ParentId=c;this.Id=f;this.Transport=e;this.Interval=b;this.Enabled=true;var d=_N(c);do{if(d.NonControls==null){d.NonControls=[]}d.NonControls.push(f);d=d.parentNode}while(d&&d.id);_N[f]=this;this.Start();var a;if(_N.Listeners==null){_N.Listeners={}}if(_N.Listeners[e]==null){a=_N.Listeners[e]=new _NListenerBundle(f,e)}else{a=_N.Listeners[e];a.Stop();a.Ids.push(f)}if(!a.Starting){setTimeout(function(){a.Start();a.Starting=null},500);a.Starting=true}}_NListener.prototype.Start=function(){this.Started=true};_NListener.prototype.Stop=function(){this.Started=false};_NListener.prototype.Destroy=function(){var b,c=_N(this.ParentId),a=_N.Listeners[this.Transport];a.Stop();do{if(c.NonControls!=null){for(b=0;b<c.NonControls.length;++b){if(c.NonControls[b]==this.Id){c.NonControls.splice(b,1)}}}c=c.parentNode}while(c&&c.id);var e=a.Ids,d=e.length;for(b=0;b<d;++b){if(e[b]==this.Id){e.splice(b,1)}}this.ParentId=null;if(e.length==0){delete _N.Listeners[this.Transport]}};function _NListenerBundle(b,a){this.Ids=[b];this.Transport=a}_NListenerBundle.prototype.Start=function(){this.Stop();this.Offset=0;var g=this,h,d,b=location.href,a="",c,l,j,k,f,e;b=(b.indexOf("#/")==-1?b.replace(location.hash,""):b.replace("#/",b.indexOf("?")==-1?"?":"&"));for(j=0,k=this.Ids.length;j<k;++j){if((f=_N(c=this.Ids[j]))&&f.ParentId&&f.Started&&f.Enabled){a+=c+",";if(e==null||e>f.Interval){e=f.Interval}}}if(a){a=a.substring(0,a.length-1);if(this.Transport=="Stream"){this.TransferDoc=new ActiveXObject("htmlfile");this.TransferDoc.open();this.TransferDoc.write("<html></html>");this.TransferDoc.close();var h=this.Request=this.TransferDoc.createElement("IFRAME");h.style.visibility="hidden";h.style.position="absolute";h.style.width=h.style.height=h.style.border="0px";h.name=this.Id+"IF";h.src="javascript:false;";this.TransferDoc.body.appendChild(h);h.contentWindow.document.open();h.contentWindow.document.close();h.contentWindow.document.body.innerHTML="<FORM id='frm' method='POST' target=_self action='"+b+"'><INPUT type='text' name='_NVisit' value='"+ ++_N.Visit+"'><INPUT type='text' name='_NApp' value='"+_NApp+"'><INPUT type='text' name='_NListener' value='"+a+"'></FORM>";h.contentWindow.document.getElementById("frm").submit();this.Timer=setInterval(function(){_NListenerStream.call(g)},e)}else{this.Request=_NXHR("POST",b,function(){_NListenerReqStateChange.call(g)},true);this.Request.send("_NVisit="+ ++_N.Visit+"&_NApp="+_NApp+"&_NListener="+a)}}};_NListenerBundle.prototype.Stop=function(){if(this.Request){this.AbortSwitch=true;if(this.Transport=="Stream"){this.Request.src="javascript:false;";this.TransferDoc.body.removeChild(this.Request);this.TransferDoc=null}else{this.Request.abort()}this.AbortSwitch=null;if(this.Timer){clearInterval(this.Timer)}this.Request=null}};function _NListenerReqStateChange(){if(this.Request.readyState==4&&this.Request.status==200){if(this.Timer){clearInterval(this.Timer)}_NProcessResponse(this.Request.responseText);this.Request=null;if(this.Transport!="Stream"&&!this.AbortSwitch){if(this.Transport=="LongPoll"){this.Start()}else{if(this.Transport=="Poll"){var a=this;setTimeout(function(){a.Start()},this.Interval)}}}}}function _NListenerStream(){var b=this.Request;if(b.contentWindow){var a=b.contentWindow.document.body;if(a){var c=a.innerText.replace(/\\n/g,"\n").replace(/\\\\/g,"\\"),d=c.lastIndexOf("/*_N2*/");if(d>this.Offset){_NProcessResponse(c.substring(this.Offset,d));this.Offset=d}}}}function _NListenersHold(){var a=_N.Listeners,b;for(b in a){a[b].Stop()}}function _NListenersCont(){var a=_N.Listeners,b;for(b in a){a[b].Start()}};